{"version":3,"sources":["../src/input.js"],"names":["initialize","inputname","readonly","questionId","readOnly","replace","shortanswerInput","document","querySelector","classList","remove","parent","parentElement","input","VisualMath","Input","rawInput","style","display","onEdit","$input","field","value","latex","dispatchEvent","Event","disabled","length","mathInput","write","parseInt","template","controlsWrapper","closest","controls","ControlList","defineDefault","forEach","html","command","define","enableAll"],"mappings":"kMAsBA,uD,+TAGO,GAAMA,CAAAA,CAAU,4CAAG,WAAOC,CAAP,CAAkBC,CAAlB,CAA4BC,CAA5B,qGAClBC,CADkB,CACPF,CADO,CAEtBD,CAAS,CAAGA,CAAS,CAACI,OAAV,CAAkB,GAAlB,CAAuB,KAAvB,CAAZ,CACIC,CAHkB,CAGCC,QAAQ,CAACC,aAAT,YAA2BP,CAA3B,EAHD,CAKtBK,CAAgB,CAACG,SAAjB,CAA2BC,MAA3B,CAAkC,UAAlC,EACIC,CANkB,CAMTL,CAAgB,CAACM,aANR,CAQlBC,CARkB,CAQV,GAAIC,WAAWC,KAAf,CAAqBT,CAArB,CAAuCK,CAAvC,CARU,CAStBE,CAAK,CAACG,QAAN,CAAeC,KAAf,CAAqBC,OAArB,CAA+B,MAA/B,CAEA,GAAI,CAAChB,CAAL,CAAe,CACXW,CAAK,CAACM,MAAN,CAAe,SAAUC,CAAV,CAAkBC,CAAlB,CAAyB,CACpCD,CAAM,CAACE,KAAP,CAAeD,CAAK,CAACE,KAAN,EAAf,CACAH,CAAM,CAACI,aAAP,CAAqB,GAAIC,CAAAA,KAAJ,CAAU,QAAV,CAArB,CACH,CAEJ,CAND,IAMO,CACHrB,CAAQ,GAAR,CACAS,CAAK,CAACa,QAAN,GACH,CAED,GAAoC,CAAhC,CAAApB,CAAgB,CAACgB,KAAjB,CAAuBK,MAA3B,CAAuC,CACnCd,CAAK,CAACe,SAAN,CAAgBC,KAAhB,CACIvB,CAAgB,CAACgB,KADrB,CAGH,CA1BqB,GA4BjBlB,CA5BiB,kCA6BK,+BAAyB0B,QAAQ,CAAC3B,CAAD,CAAjC,CA7BL,SA6BZ4B,CA7BY,QA8BdC,CA9Bc,CA8BI1B,CAAgB,CAAC2B,OAAjB,CAAyB,YAAzB,EAAuCzB,aAAvC,CAAqD,mBAArD,CA9BJ,CA+Bd0B,CA/Bc,CA+BH,GAAIpB,WAAWqB,WAAf,CAA2BH,CAA3B,CA/BG,CAgClB,GAAiB,IAAb,GAAAD,CAAJ,CAAuB,CACnBG,CAAQ,CAACE,aAAT,EACH,CAFD,IAEO,CACHL,CAAQ,CAACM,OAAT,CAAiB,SAAAf,CAAK,CAAI,IAClBgB,CAAAA,CAAI,CAAGhB,CAAK,OADM,CAElBiB,CAAO,CAAGjB,CAAK,WAFG,CAGtBY,CAAQ,CAACM,MAAT,CAAgBD,CAAhB,CAAyBD,CAAzB,CAA+B,SAAAjB,CAAK,QAAIA,CAAAA,CAAK,CAACQ,KAAN,CAAYU,CAAZ,CAAJ,CAApC,CACH,CAJD,CAKH,CACDL,CAAQ,CAACO,SAAT,GAzCkB,yCAAH,uDAAhB,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * @module     qtype_shortmath/input\n * @package    qtype_shortmath\n * @author     Andr√© Storhaug <andr3.storhaug@gmail.com>\n * @copyright  2018 NTNU\n */\nimport VisualMath from \"qtype_shortmath/visual-math-input\";\nimport { getShortmathEditorconfig } from \"./api_helpers\";\n\nexport const initialize = async (inputname, readonly, questionId) => {\n    var readOnly = readonly;\n    inputname = inputname.replace(\":\", \"\\\\:\");\n    var shortanswerInput = document.querySelector(`#${inputname}`);\n    // Remove class \"d-inline\" added in shortanswer renderer class, which prevents input from being hidden.\n    shortanswerInput.classList.remove('d-inline');\n    var parent = shortanswerInput.parentElement;\n\n    var input = new VisualMath.Input(shortanswerInput, parent);\n    input.rawInput.style.display = \"none\";\n\n    if (!readonly) {\n        input.onEdit = function ($input, field) {\n            $input.value = field.latex();\n            $input.dispatchEvent(new Event('change')); // Event firing needs to be on a vanilla dom object.\n        };\n\n    } else {\n        readOnly = true;\n        input.disabled = true;\n    }\n\n    if (shortanswerInput.value.length > 0) {\n        input.mathInput.write(\n            shortanswerInput.value\n        );\n    }\n\n    if (!readOnly) {\n        const template = await getShortmathEditorconfig(parseInt(questionId));\n        var controlsWrapper = shortanswerInput.closest('.shortmath').querySelector('.controls_wrapper');\n        var controls = new VisualMath.ControlList(controlsWrapper);\n        if (template === null) {\n            controls.defineDefault();\n        } else {\n            template.forEach(value => {\n                let html = value['button'];\n                let command = value['expression'];\n                controls.define(command, html, field => field.write(command));\n            });\n        }\n        controls.enableAll();\n    }\n};\n"],"file":"input.min.js"}