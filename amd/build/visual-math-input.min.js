"use strict";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}define(["jquery","./mathquill"],function(e,t){var n=null,i=function(){function i(a,s){var r=this;_classCallCheck(this,i),this.$input=e(a),this.$parent=e(s);var l=document.createElement("div");e(l).addClass("visual-math-input-field");var o=t.getInterface(2);this.field=o.MathField(l,{spaceBehavesLikeTab:!0,handlers:{edit:function(t){r.onEdit(e(a),t)}}}),this.$parent.append(l),this.onEdit=function(e,t){return e.val("\\[ "+t.latex()+" \\]")},this.$textarea.on("blur",function(){return n=r})}return _createClass(i,[{key:"enable",value:function(){this.$textarea.prop("disabled",!1)}},{key:"disable",value:function(){this.$textarea.prop("disabled",!0)}},{key:"$textarea",get:function(){return e(this.field.el()).find("textarea")}}]),i}(),a=function(){function t(e,n,i){_classCallCheck(this,t),this.name=e,this.text=n,this.onClick=i,this.$element=null}return _createClass(t,[{key:"enable",value:function(){var t=this;if(null===this.$element){var i=document.createElement("button");this.$element=e(i),this.$element.html(this.text),this.$element.addClass("visual-math-input-control btn btn-primary"),this.$element.on("click",function(e){e.preventDefault(),null!==n&&(t.onClick(n.field),n.field.focus())})}}}]),t}(),s=function(){function t(n){_classCallCheck(this,t),this.controls=[],this.$wrapper=e(n),this.$wrapper.addClass("visual-math-input-wrapper"),this.defineDefault()}return _createClass(t,[{key:"define",value:function(e,t,n){this.controls[e]=new a(e,t,n)}},{key:"enable",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var r=a.value,l=this.controls[r];l.enable(),this.$wrapper.append(l.$element)}}catch(e){n=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}}},{key:"enableAll",value:function(){for(var e in this.controls){var t=this.controls[e];t.enable(),this.$wrapper.append(t.$element)}}},{key:"defineDefault",value:function(){var e='<div class="mq-math-mode" style="cursor:pointer;font-size:100%;">';e+='<span class="mq-root-block">',e+='<span class="mq-non-leaf">',e+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">(</span>',e+='<span class="mq-non-leaf" style="margin-top:0;">',e+='<span class="mq-array mq-non-leaf">',e+='<span style="font-size: 14px;"><var>n</var></span>',e+='<span style="font-size: 14px;"><var>k</var></span>',e+="</span></span>",e+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">)</span></span>',e+="</span></div>",this.define("sqrt","&radic;",function(e){return e.cmd("\\sqrt")}),this.define("int","&int;",function(e){return e.cmd("\\int")}),this.define("dint","&int;<sub>0</sub><sup>1</sup>",function(e){e.cmd("\\int"),e.typedText("_0").moveToRightEnd(),e.typedText("^1").moveToRightEnd()}),this.define("sum","&sum;",function(e){return e.cmd("\\sum")}),this.define("lim","lim",function(e){e.cmd("\\lim").typedText("_").write("x").cmd("\\to").write("0").moveToRightEnd()}),this.define("nchoosek",e,function(e){return e.cmd("\\choose")}),this.define("divide","/",function(e){return e.cmd("\\frac")}),this.define("plusminus","&plusmn;",function(e){return e.cmd("\\pm")}),this.define("theta","&theta;",function(e){return e.cmd("\\theta")}),this.define("pi","&pi;",function(e){return e.cmd("\\pi")}),this.define("infinity","&infin;",function(e){return e.cmd("\\infinity")}),this.define("caret","x<sup>y<sup>",function(e){return e.cmd("^")})}}]),t}();return{Input:i,Control:a,ControlList:s}});