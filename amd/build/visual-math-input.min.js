define(["jquery","./mathquill"],function(e,t){let s=null;class n{constructor(e,t,s){this.name=e,this.text=t,this.onClick=s,this.$element=null}enable(){if(null!==this.$element)return;let t=document.createElement("button");this.$element=e(t),this.$element.html(this.text),this.$element.addClass("visual-math-input-control btn btn-primary"),this.$element.on("click",e=>{e.preventDefault(),null!==s&&(this.onClick(s.field),s.field.focus())})}}return{Input:class{constructor(n,i){this.$input=e(n),this.$parent=e(i);let a=document.createElement("div");e(a).addClass("visual-math-input-field");let l=t.getInterface(2);this.field=l.MathField(a,{spaceBehavesLikeTab:!0,handlers:{edit:t=>{this.onEdit(e(n),t)}}}),this.$parent.append(a),this.onEdit=((e,t)=>e.val("\\[ "+t.latex()+" \\]")),this.$textarea.on("blur",()=>s=this)}get $textarea(){return e(this.field.el()).find("textarea")}enable(){this.$textarea.prop("disabled",!1)}disable(){this.$textarea.prop("disabled",!0)}},Control:n,ControlList:class{constructor(t){this.controls=[],this.$wrapper=e(t),this.$wrapper.addClass("visual-math-input-wrapper"),this.defineDefault()}define(e,t,s){this.controls[e]=new n(e,t,s)}enable(e){for(let t of e){let e=this.controls[t];e.enable(),this.$wrapper.append(e.$element)}}enableAll(){for(let e in this.controls){let t=this.controls[e];t.enable(),this.$wrapper.append(t.$element)}}defineDefault(){let e='<div class="mq-math-mode" style="cursor:pointer;font-size:100%;">';e+='<span class="mq-root-block">',e+='<span class="mq-non-leaf">',e+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">(</span>',e+='<span class="mq-non-leaf" style="margin-top:0;">',e+='<span class="mq-array mq-non-leaf">',e+='<span style="font-size: 14px;"><var>n</var></span>',e+='<span style="font-size: 14px;"><var>k</var></span>',e+="</span></span>",e+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">)</span></span>',e+="</span></div>",this.define("sqrt","&radic;",e=>e.cmd("\\sqrt")),this.define("int","&int;",e=>e.cmd("\\int")),this.define("dint","&int;<sub>0</sub><sup>1</sup>",e=>{e.cmd("\\int"),e.typedText("_0").moveToRightEnd(),e.typedText("^1").moveToRightEnd()}),this.define("sum","&sum;",e=>e.cmd("\\sum")),this.define("lim","lim",e=>{e.cmd("\\lim").typedText("_").write("x").cmd("\\to").write("0").moveToRightEnd()}),this.define("nchoosek",e,e=>e.cmd("\\choose")),this.define("divide","/",e=>e.cmd("\\frac")),this.define("plusminus","&plusmn;",e=>e.cmd("\\pm")),this.define("theta","&theta;",e=>e.cmd("\\theta")),this.define("pi","&pi;",e=>e.cmd("\\pi")),this.define("infinity","&infin;",e=>e.cmd("\\infinity"))}}}});