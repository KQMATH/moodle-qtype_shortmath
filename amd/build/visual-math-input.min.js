define(["jquery","./mathquill"],function(s,t){let e=null;class n{constructor(s,t,e){this.name=s,this.text=t,this.onClick=e,this.$element=null}enable(){if(null!==this.$element)return;let t=document.createElement("button");this.$element=s(t),this.$element.html(this.text),this.$element.addClass("visual-math-input-control btn btn-primary"),this.$element.on("click",s=>{s.preventDefault(),null!==e&&(this.onClick(e.field),e.field.focus())})}}return{Input:class{constructor(n,a){this.$input=s(n),this.$parent=s(a);let l=document.createElement("div");s(l).addClass("visual-math-input-field");let i=t.getInterface(2);this.field=i.MathField(l,{spaceBehavesLikeTab:!0,handlers:{edit:t=>{this.onEdit(s(n),t)}}}),this.$parent.append(l),this.onEdit=((s,t)=>s.val("\\[ "+t.latex()+" \\]")),this.$textarea.on("blur",()=>e=this)}get $textarea(){return s(this.field.el()).find("textarea")}enable(){this.$textarea.prop("disabled",!1)}disable(){this.$textarea.prop("disabled",!0)}},Control:n,ControlList:class{constructor(t){this.controls=[],this.$wrapper=s(t),this.$wrapper.addClass("visual-math-input-wrapper"),this.defineDefault()}define(s,t,e){this.controls[s]=new n(s,t,e)}enable(s){for(let t of s){let s=this.controls[t];s.enable(),this.$wrapper.append(s.$element)}}enableAll(){for(let s in this.controls){let t=this.controls[s];t.enable(),this.$wrapper.append(t.$element)}}defineDefault(){let s='<div class="mq-math-mode" style="cursor:pointer;font-size:100%;">';s+='<span class="mq-root-block">',s+='<span class="mq-non-leaf">',s+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">(</span>',s+='<span class="mq-non-leaf" style="margin-top:0;">',s+='<span class="mq-array mq-non-leaf">',s+='<span style="font-size: 14px;"><var>n</var></span>',s+='<span style="font-size: 14px;"><var>k</var></span>',s+="</span></span>",s+='<span class="mq-paren mq-scaled" style="transform: scale(0.8, 1.5);">)</span></span>',s+="</span></div>";let t='<div class="mq-math-mode" style="cursor:pointer;font-size:100%;">';t+='<span class="mq-root-block">',t+="<var>x</var>",t+='<span class="mq-supsub mq-non-leaf mq-sup-only">',t+='<span class="mq-sup">',t+="<var>y</var>",t+="</span></span></span></div>",this.define("sqrt",'<span class="mq-root-block">&radic;</span>',s=>s.cmd("\\sqrt")),this.define("int",'<span class="mq-root-block">&int;</span>',s=>s.cmd("\\int")),this.define("dint",'<span class="mq-root-block">&int;<sub>0</sub><sup>1</sup></span>',s=>{s.cmd("\\int"),s.typedText("_0").moveToRightEnd(),s.typedText("^1").moveToRightEnd()}),this.define("sum",'<span class="mq-root-block"><span class="mq-large-operator mq-non-leaf">&sum;</span></span>',s=>s.cmd("\\sum")),this.define("lim",'<span class="mq-root-block">lim</span>',s=>{s.cmd("\\lim").typedText("_").write("x").cmd("\\to").write("0").moveToRightEnd()}),this.define("nchoosek",s,s=>s.cmd("\\choose")),this.define("divide",'<span class="mq-root-block">/</span>',s=>s.cmd("\\frac")),this.define("plusminus",'<span class="mq-root-block">&plusmn;</span>',s=>s.cmd("\\pm")),this.define("theta",'<span class="mq-root-block">&theta;</span>',s=>s.cmd("\\theta")),this.define("pi",'<span class="mq-root-block">&pi;</span>',s=>s.cmd("\\pi")),this.define("infinity",'<span class="mq-root-block">&infin;</span>',s=>s.cmd("\\infinity")),this.define("caret",t,s=>s.cmd("^"))}}}});